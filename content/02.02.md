#技巧2 理解子网和CIDR
##分类地址
通常情况下，IP地址分为5个类。这种分割称作分类地址。

D类地址用于多点广播地址，E类地址为将来使用而保留。剩下来的A类地址、B类地址和C类地址用于标识单个的网络和主机。

一个地址的分类是以开始的为1的位的个数来标识的。A类地址的开头有0个为1的位，B类地址的开头有1个为1的位，C类地址有两个，以此类推。因为余下来的位的解释依赖于地址的类别，所以标识地址的类别是很重要的。

![](../images/02.01.png)

A类地址、B类地址和C类地址的生下来的位分成两部分。第一部分是网络ID，它标识该地址所指向的特定网络。在这之后是主机ID，它标识网络中的一台特定的主机。

把地址空间分为几类的原因是为了在不浪费地址空间的情况下尽可能地提供灵活性。例如，A类地址用于具有大量主机（16777214）的网络。因为网络ID为7位，所以总共有128个A类网络。

跟A类网络对应的是C类网络。C类网络的数量很多，但是每一个都只有254个可获得的主机ID。二者相反的是，A类地址意味着包含大量主机的很少的网络，C类地址意味着包含很少主机的大量网络。

![](../images/02.02.png)

##子网划分
子网划分是通过使用部分主机ID指定段（也就是子网）来进行的，外部的主机连接的是段，其余的主机ID用来标识特定的主机。

在使用子网时，有四个不同类型的广播地址：有限广播、网络直接广播、子网直接广播和全子网直接广播。

- **有限广播** 有限广播地址是255.255.255.255。称它为有限是因为使用它的数据报不会被路由器转发。它们总是限制在本地网线之内。它基本上是用在启动时，这个时候主机不知道它的IP地址或子网地址。
- **网络直接广播** 网络直接广播的地址设置为指定网络的网络ID以及其主机ID的所有位都设置为1。例如，网络190.50.0.0的网络直接广播地址是190.50.255.255。带有这种类型广播地址的数据报传递给目的网络中的所有主机。
- **子网直接广播** 一个子网直接广播地址指定了网络ID和子网ID。主机号部分设置为全1。应当注意的是，在不知道子网掩码的情况下是不可能知道一个地址是否为子网直接广播地址的。例如，如果路由器知道了子网掩码是255.255.255.0，就会把地址190.50.1.255看作子网直接广播消息。如果路由器认为子网掩码是255.255.0.0，那么该地址就会看成是一个广播地址。
- **全子网直接广播地址** 这种类型的广播地址指定网络地址，并把子网和主机部分设置为全1。对于子网直接广播地址，在区别这个地址时必须运用子网掩码的知识。

##CIDR
子网划分解决了分类地址的一个问题：路由表条目的无限增长。它通过更好地利用给定网络内的主机ID来帮助IP地址的消耗减少到很小的程度。

另一个分类地址的严重问题是B类网络ID的消耗。因为大多数的中等规模以及更大规模的组织需要比C类网络ID所提供的更多的IP地址，所以它们获取B类网络ID。随着B类网络ID的消耗，各个组织不得不获取C类网络ID块，但是这将再次导致需要引入子网来解决的问题：Internet上路由表的增长。

不分类域间路由（classless interdomain routing，CIDR）通过“反向操作”子网划分来解决这个问题。在子网划分中，IP地址的网络ID部分变长了，而CIDR使它变短。 

跟子网划分不一样的是，这个网络掩码不扩展IP地址的网络部分，而是缩短它。因此，CIDR也称作supernetting。另外跟子网划分不一样的是，网络掩码向外导出网络部分。它成为指向该网络的每个路由表条目的一部分。

在实际中，“掩码”仅仅是一个数字，称作前缀，它指定地址的网络部分的以位计的长度。